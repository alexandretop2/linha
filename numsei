-- Variáveis iniciais
local lineEnabled = false
local points = {}  -- Armazena os pontos da linha
local player = game.Players.LocalPlayer
local car = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
local carSpeed = 0  -- A velocidade do carro
local lineParts = {}  -- Armazena as partes da linha

-- Criar GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Botão de Ativar/Desativar Linha
local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0, 120, 0, 40)
toggleButton.Position = UDim2.new(0, 10, 0, 10)  -- Canto superior esquerdo
toggleButton.Text = "Ativar Linha"
toggleButton.BackgroundColor3 = Color3.fromRGB(85, 170, 255)
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.Font = Enum.Font.GothamBold
toggleButton.TextSize = 18
toggleButton.Parent = screenGui

-- Botão de Adicionar Ponto
local addPointButton = Instance.new("TextButton")
addPointButton.Size = UDim2.new(0, 120, 0, 40)
addPointButton.Position = UDim2.new(0, 10, 0, 60)  -- Logo abaixo do outro botão
addPointButton.Text = "Adicionar Ponto"
addPointButton.BackgroundColor3 = Color3.fromRGB(85, 255, 85)
addPointButton.TextColor3 = Color3.fromRGB(255, 255, 255)
addPointButton.Font = Enum.Font.GothamBold
addPointButton.TextSize = 18
addPointButton.Parent = screenGui

-- Função para criar a linha de traçado
local function createRaceLine()
    -- Apaga a linha anterior
    for _, part in pairs(lineParts) do
        part:Destroy()
    end
    lineParts = {}

    -- Desenha a linha conectando os pontos
    for i = 2, #points do
        local startPoint = points[i - 1]
        local endPoint = points[i]

        -- Criar uma parte fina como linha
        local part = Instance.new("Part")
        part.Size = Vector3.new(0.5, 0.5, (startPoint - endPoint).Magnitude)
        part.Position = (startPoint + endPoint) / 2
        part.Anchored = true
        part.CanCollide = false
        part.Parent = workspace

        -- Ajustar a orientação da linha
        part.CFrame = CFrame.lookAt(startPoint, endPoint) * CFrame.new(0, 0, -part.Size.Z / 2)

        -- Cor da linha baseado na velocidade
        local color = Color3.fromRGB(255, 255, 255)  -- Branco padrão
        if carSpeed > 60 then
            color = Color3.fromRGB(0, 255, 0)  -- Verde para acelerar
        elseif carSpeed < 30 then
            color = Color3.fromRGB(255, 0, 0)  -- Vermelho para freiar
        end
        part.Color = color

        table.insert(lineParts, part)
    end
end

-- Função para adicionar pontos à linha
local function addPointToLine()
    if car then
        table.insert(points, car.Position)
        if lineEnabled then
            createRaceLine()
        end
    end
end

-- Função para alternar a linha de corrida
local function toggleRaceLine()
    lineEnabled = not lineEnabled
    if lineEnabled then
        createRaceLine()
        toggleButton.Text = "Desativar Linha"
    else
        -- Apaga a linha
        for _, part in pairs(lineParts) do
            part:Destroy()
        end
        lineParts = {}
        toggleButton.Text = "Ativar Linha"
    end
end

-- Atualiza a velocidade do carro a cada segundo
game:GetService("RunService").RenderStepped:Connect(function()
    if car then
        carSpeed = car.Velocity.Magnitude
        if lineEnabled then
            createRaceLine()
        end
    end
end)

-- Conectar os botões às funções
toggleButton.MouseButton1Click:Connect(toggleRaceLine)
addPointButton.MouseButton1Click:Connect(addPointToLine)
